{% extends 'base.html.twig' %}

{% block title %}PokeAPI Test - Dev Only{% endblock %}

{% block body %}
<div class="container">
    <header>
        <h1>üß™ PokeAPI Integration Test</h1>
        <p class="subtitle">Development Environment Only</p>
    </header>

    <main>
        {% if error %}
            <div style="background: #fee; border: 2px solid #c33; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h2 style="color: #c33;">‚ö†Ô∏è Error</h2>
                <p><strong>{{ error }}</strong></p>
            </div>
        {% else %}
            <div style="background: #e7f3ff; border-left: 4px solid #667eea; padding: 15px; margin-bottom: 20px; border-radius: 4px;">
                <p><strong>Response Time:</strong> {{ responseTime }} ms</p>
                <p style="margin: 5px 0 0 0; color: #666; font-size: 0.9em;">
                    First visit = API call (slower) | Second visit = cached (faster)
                </p>
            </div>

            <section style="margin-bottom: 30px;">
                <h2>Pokemon Types</h2>
                <p>Showing first 10 of {{ totalTypes }} types:</p>
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
                    {% for type in types %}
                        <span style="background: #667eea; color: white; padding: 8px 15px; border-radius: 20px; font-size: 0.9em;">
                            {{ type }}
                        </span>
                    {% endfor %}
                </div>
            </section>

            {% if sampleType and samplePokemonList %}
                <section style="margin-bottom: 30px; background: #f8f9fa; padding: 20px; border-radius: 8px;">
                    <h2>Sample Pokemon List for "{{ sampleType }}" Type</h2>
                    <p>First 5 pokemon:</p>
                    <ul style="list-style: inside; color: #555;">
                        {% for pokemon in samplePokemonList %}
                            <li>{{ pokemon }}</li>
                        {% endfor %}
                    </ul>
                </section>
            {% endif %}

            {% if pikachuDetails %}
                <section style="margin-bottom: 30px;">
                    <h2>Sample Pokemon Details: {{ pikachuDetails.name|capitalize }}</h2>

                    <div style="display: grid; grid-template-columns: 200px 1fr; gap: 20px; align-items: start;">
                        {% if pikachuDetails.sprite %}
                            <div style="text-align: center;">
                                <img src="{{ pikachuDetails.sprite }}" alt="{{ pikachuDetails.name }}" style="width: 150px; height: 150px; background: #f0f0f0; border-radius: 8px; padding: 10px;">
                                <p style="margin-top: 10px; font-weight: bold;">ID: #{{ pikachuDetails.id }}</p>
                            </div>
                        {% endif %}

                        <div>
                            <div style="margin-bottom: 15px;">
                                <h3 style="margin-bottom: 5px;">Types</h3>
                                <div style="display: flex; gap: 10px;">
                                    {% for type in pikachuDetails.types %}
                                        <span style="background: #764ba2; color: white; padding: 5px 12px; border-radius: 15px; font-size: 0.85em;">
                                            {{ type }}
                                        </span>
                                    {% endfor %}
                                </div>
                            </div>

                            <div style="margin-bottom: 15px;">
                                <h3 style="margin-bottom: 5px;">Stats</h3>
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                                    {% for statName, statValue in pikachuDetails.stats %}
                                        <div style="background: #e7f3ff; padding: 10px; border-radius: 5px;">
                                            <strong>{{ statName|replace({'-': ' '})|title }}:</strong> {{ statValue }}
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>

                            <div>
                                <h3 style="margin-bottom: 5px;">Abilities</h3>
                                <ul style="list-style: inside; color: #555;">
                                    {% for ability in pikachuDetails.abilities %}
                                        <li>{{ ability|replace({'-': ' '})|title }}</li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>
            {% endif %}

            <section style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; border-radius: 4px;">
                <h3 style="margin-bottom: 10px;">Cache Test Instructions</h3>
                <ol style="color: #555; line-height: 1.8;">
                    <li>Note the response time above (this is your first visit)</li>
                    <li>Refresh the page (F5) and observe the response time</li>
                    <li>Second visit should be significantly faster (cached data)</li>
                    <li>To clear cache: <code style="background: #f0f0f0; padding: 2px 6px; border-radius: 3px;">docker compose exec php bin/console cache:clear</code></li>
                </ol>
            </section>
        {% endif %}
    </main>

    <footer style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e0e0e0; text-align: center; color: #888;">
        <p><strong>‚ö†Ô∏è This route is only available in dev environment</strong></p>
        <p style="margin-top: 5px; font-size: 0.9em;">Will be removed before production</p>
    </footer>
</div>
{% endblock %}
